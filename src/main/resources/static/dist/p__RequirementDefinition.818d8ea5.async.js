(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[144],{47759:function(oe,L,n){"use strict";n.r(L),n.d(L,{default:function(){return be}});var ie=n(43358),K=n(90290),Y=n(57663),G=n(71577),H=n(93224),ue=n(62350),N=n(75443),F=n(11849),z=n(34792),Z=n(48086),g=n(3182),y=n(2824),W=n(94043),u=n.n(W),le=n(75362),s=n(67294),se=n(19595),B=n(48971);function je(a){return J.apply(this,arguments)}function J(){return J=_asyncToGenerator(_regeneratorRuntime.mark(function a(r){return _regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",request("/algz/indicatormanager/indicator",{params:r}));case 1:case"end":return e.stop()}},a)})),J.apply(this,arguments)}function de(a){return Q.apply(this,arguments)}function Q(){return Q=(0,g.Z)(u().mark(function a(r){return u().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,B.WY)("/algz/indicatormanager/indicatornodes",{params:r}));case 1:case"end":return e.stop()}},a)})),Q.apply(this,arguments)}function ce(a,r){return X.apply(this,arguments)}function X(){return X=(0,g.Z)(u().mark(function a(r,c){return u().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:return D.abrupt("return",(0,B.WY)("/algz/requirementdefinition/definitions",(0,F.Z)({method:"GET",params:(0,F.Z)({},r)},c||{})));case 1:case"end":return D.stop()}},a)})),X.apply(this,arguments)}function fe(a){return q.apply(this,arguments)}function q(){return q=(0,g.Z)(u().mark(function a(r){return u().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,B.WY)("/algz/requirementdefinition/adddefinition",{method:"POST",data:r}));case 1:case"end":return e.stop()}},a)})),q.apply(this,arguments)}function ve(a){return _.apply(this,arguments)}function _(){return _=(0,g.Z)(u().mark(function a(r){return u().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,B.WY)("/algz/requirementdefinition/publishdefinition",{method:"POST",data:r}));case 1:case"end":return e.stop()}},a)})),_.apply(this,arguments)}function me(a){return ee.apply(this,arguments)}function ee(){return ee=(0,g.Z)(u().mark(function a(r){return u().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,B.WY)("/algz/requirementdefinition/deldefinition",{method:"POST",data:r}));case 1:case"end":return e.stop()}},a)})),ee.apply(this,arguments)}function pe(a){return ne.apply(this,arguments)}function ne(){return ne=(0,g.Z)(u().mark(function a(r){return u().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,B.WY)("/algz/requirementdefinition/definitiondetails",{params:r}));case 1:case"end":return e.stop()}},a)})),ne.apply(this,arguments)}function xe(a){return te.apply(this,arguments)}function te(){return te=_asyncToGenerator(_regeneratorRuntime.mark(function a(r){return _regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",request("/algz/requirementdefinition/deldefinitiondetail",{method:"POST",requestType:"form",data:r}));case 1:case"end":return e.stop()}},a)})),te.apply(this,arguments)}var he=n(49101),Pe=n(13062),re=n(71230),Se=n(89032),U=n(15746),Fe=n(47673),ge=n(4107),ae=n(86582),ye=n(37476),Ae=n(32157),De=n(87524),t=n(85893),Ce=(0,s.forwardRef)(function(a,r){(0,s.useImperativeHandle)(r,function(){return{childHandleClick:c}});var c=function(D){console.log("\u6211\u662F\u5B50\u7EC4\u4EF6")};return(0,t.jsx)(De.Z,{showLine:!0,showIcon:!1,onDoubleClick:a.onTreeDoubleClick,treeData:a.treeData})}),Te=(0,s.forwardRef)(function(a,r){var c=(0,s.useState)(),e=(0,y.Z)(c,2),D=e[0],A=e[1],w=[{dataIndex:"index",valueType:"indexBorder",width:48},{dataIndex:"indicatorParentId",width:0,filteredValue:D||null,onFilter:function(T,x){var I;return(I=x.indicatorParentId)===null||I===void 0?void 0:I.includes(T)},renderText:function(){return" "}},{title:"\u9700\u6C42\u63CF\u8FF0",dataIndex:"description",render:function(T,x){return(0,t.jsx)("a",{onClick:function(){console.log(r+"")},children:T})}},{title:"\u6307\u6807\u540D\u79F0",dataIndex:"indicatorName",valueType:"textarea"},a.isEditor?{title:"\u64CD\u4F5C",dataIndex:"option",valueType:"option",render:function(T,x){return[(0,t.jsx)(N.Z,{title:"\u662F\u5426\u5220\u9664\u6570\u636E\uFF1F",onConfirm:function(){a.onDelRecord(x)},okText:"\u662F",cancelText:"\u5426",children:(0,t.jsx)("a",{children:"\u5220\u9664"})},"")]}}:{}],R=(0,s.useState)("0"),E=(0,y.Z)(R,2),O=E[0],M=E[1];return(0,t.jsx)(re.Z,{children:(0,t.jsx)(U.Z,{span:24,children:(0,t.jsx)(se.ZP,{actionRef:r,rowKey:"indicatorId",search:!1,request:a.onTableReuqest,columns:w,pagination:!1,options:!1,toolbar:{menu:{type:"tab",activeKey:O,items:[{key:"0",label:(0,t.jsx)("span",{children:"\u5168\u90E8"})},{key:"1",label:(0,t.jsx)("span",{children:"\u52A8\u529B\u8F85\u52A9"})},{key:"2",label:(0,t.jsx)("span",{children:"\u4F5C\u52A8"})},{key:"3",label:(0,t.jsx)("span",{children:"\u73AF\u63A7"})},{key:"4",label:(0,t.jsx)("span",{children:"\u4F9B\u7535"})},{key:"5",label:(0,t.jsx)("span",{children:"\u71C3\u6CB9"})}],onChange:function(T){T=="0"?A([]):A([T]),M(T)}}}})})})}),Ie=Te,Re=function(r){var c,e=(0,s.useRef)(),D=(0,s.useRef)(null),A=(0,s.useState)([]),w=(0,y.Z)(A,2),R=w[0],E=w[1],O=(0,s.useState)(function(){return[{title:"Tree Node",key:"2",isLeaf:!0}]}),M=(0,y.Z)(O,2),C=M[0],T=M[1],x=function(d,l){if(C.some(function(i){return i.key==l.key}))Z.default.error("\u53EA\u80FD\u6DFB\u52A0\u5B50\u7ED3\u70B9\uFF01");else{var o;if(!R.some(function(i,k,P){return i.indicatorId==l.key})){var m;E([].concat((0,ae.Z)(R),[{id:void 0,indicatorId:l.key+"",indicatorName:l.title+"",description:"",indicatorParentId:(m=l.extProps)===null||m===void 0?void 0:m.parentId}]))}(o=e.current)===null||o===void 0||o.reload()}},I=function(d,l,o){return console.log("onTableReuqest:",R,d,l,o),Promise.resolve({data:function(){return R},success:!0})};return(0,s.useEffect)(function(){console.log("\u6A21\u62DFcomponentDidMount\uFF0C\u5373\u53EA\u8FD0\u884C\u4E00\u6B21\u8BE5\u51FD\u6570")},[]),(0,t.jsxs)(ye.Z,{title:"\u9700\u6C42\u8BE6\u7EC6\u5B9A\u4E49",width:"800px",modalProps:{onCancel:function(){var v=(0,g.Z)(u().mark(function l(){return u().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:case"end":return m.stop()}},l)}));function d(){return v.apply(this,arguments)}return d}()},visible:r.modalVisible,onVisibleChange:function(){var v=(0,g.Z)(u().mark(function d(l){var o;return u().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(!l){i.next=16;break}return E([]),i.t0=T,i.next=5,de({key:"0"});case 5:if(i.t1=i.sent,(0,i.t0)(i.t1),!r.currentRecord){i.next=16;break}return i.t2=E,i.t3=ae.Z,i.next=12,pe({definitonId:r.currentRecord.id});case 12:i.t4=i.sent,i.t5=(0,i.t3)(i.t4),(0,i.t2)(i.t5),(o=e.current)===null||o===void 0||o.reload();case 16:r.onVisibleChange(l);case 17:case"end":return i.stop()}},d)}));return function(d){return v.apply(this,arguments)}}(),onFinish:function(){var v=(0,g.Z)(u().mark(function d(l){var o,m,i;return u().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:if(m=(o=D.current)===null||o===void 0?void 0:o.input.value,m!=""){P.next=6;break}return Z.default.error("\u8BF7\u8F93\u5165\u540D\u79F0\uFF01"),P.abrupt("return");case 6:return P.next=8,function(){var V=(0,g.Z)(u().mark(function p(h){var b;return u().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return b=Z.default.loading("\u6B63\u5728\u63D0\u4EA4"),f.prev=1,console.log("read foo state in addDefinition function",h),f.next=5,fe((0,F.Z)({},h));case 5:b(),Z.default.success("\u63D0\u4EA4\u6210\u529F\uFF01"),r.onVisibleChange(!1),r.updateDefinitionTable(),f.next=15;break;case 11:f.prev=11,f.t0=f.catch(1),b(),Z.default.error("\u63D0\u4EA4\u5931\u8D25,\u8BF7\u518D\u8BD5\u4E00\u6B21\uFF01");case 15:case"end":return f.stop()}},p,null,[[1,11]])}));return function(p){return V.apply(this,arguments)}}()({id:(i=r.currentRecord)===null||i===void 0?void 0:i.id,name:m,detailList:(0,ae.Z)(R)});case 8:case"end":return P.stop()}},d)}));return function(d){return v.apply(this,arguments)}}(),submitter:{render:function(d,l){return[l[0],r.isEditor?l[1]:""]}},children:[(0,t.jsx)(re.Z,{gutter:[5,5],style:{marginBottom:"15px"},children:(0,t.jsx)(U.Z,{span:12,children:(0,t.jsx)(ge.Z,{ref:D,style:{width:"80%"},placeholder:"\u540D\u79F0",defaultValue:r.currentRecord==null?"":(c=r.currentRecord)===null||c===void 0?void 0:c.name})})}),(0,t.jsxs)(re.Z,{gutter:[5,5],children:[(0,t.jsx)(U.Z,{span:8,children:(0,t.jsx)(Ce,{onTreeDoubleClick:x,treeData:C})}),(0,t.jsx)(U.Z,{span:16,children:(0,t.jsx)(Ie,{ref:e,isEditor:r.isEditor,onTableReuqest:I,onActionKeyChange:function(d){var l;E(R.filter(function(o){return o.indicatorParentId==d})),(l=e.current)===null||l===void 0||l.reload(),console.log(d)},onDelRecord:function(d){var l;E(R.filter(function(o){return o.indicatorId!=d.indicatorId})),(l=e.current)===null||l===void 0||l.reload()}})})]})]})},Ze=Re,Ee=n(75640),be=function(){var a=(0,s.useState)(!0),r=(0,y.Z)(a,2),c=r[0],e=r[1],D=(0,s.useState)("0"),A=(0,y.Z)(D,2),w=A[0],R=A[1],E=(0,s.useState)(!1),O=(0,y.Z)(E,2),M=O[0],C=O[1],T=(0,s.useState)(),x=(0,y.Z)(T,2),I=x[0],v=x[1],d=function(p,h,b){return(0,t.jsx)(N.Z,{title:"\u662F\u5426".concat(p,"\u8FD9\u4E2A\u9879\u76EE\uFF1F"),onConfirm:(0,g.Z)(u().mark(function $(){var f,S;return u().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return f=Z.default.loading("\u6B63\u5728".concat(p)),j.prev=1,j.next=4,b((0,F.Z)({},h));case 4:return f(),Z.default.success("\u6210\u529F\uFF01"),(S=k.current)===null||S===void 0||S.reload(),j.abrupt("return",!0);case 10:return j.prev=10,j.t0=j.catch(1),f(),Z.default.error("\u5931\u8D25,\u8BF7\u518D\u8BD5\u4E00\u6B21\uFF01"),j.abrupt("return",!1);case 15:case"end":return j.stop()}},$,null,[[1,10]])})),okText:"\u662F",cancelText:"\u5426",children:(0,t.jsx)("a",{children:p})},"popconfirm1")},l=(0,s.useState)(!1),o=(0,y.Z)(l,2),m=o[0],i=o[1],k=(0,s.useRef)(),P=[{dataIndex:"index",valueType:"indexBorder",width:48},{title:"\u540D\u79F0",dataIndex:"name"},{title:"\u8BF4\u660E",dataIndex:"description",valueType:"textarea"},{title:"\u521B\u5EFA\u4EBA",dataIndex:"creatorName"},{title:"\u72B6\u6001",dataIndex:"state",hideInForm:!0,valueEnum:{0:{text:"\u5F85\u53D1\u5E03",status:"Default"},1:{text:"\u5F85\u586B\u5145",status:"Processing"},2:{text:"\u5DF2\u586B\u5145",status:"Processing"},3:{text:"\u5DF2\u5BA1\u7B7E",status:"Processing"},4:{text:"\u6709\u53CD\u9988",status:"Processing"},5:{text:"\u5DF2\u5B8C\u6210",status:"Success"},6:{text:"\u5F02\u5E38",status:"Error"}}},{title:"\u521B\u5EFA\u65E5\u671F",sorter:!0,dataIndex:"createDate",valueType:"dateTime",renderFormItem:function(p,h,b){var $=h.defaultRender,f=(0,H.Z)(h,["defaultRender"]),S=b.getFieldValue("status");return"".concat(S)==="0"?!1:$(p)}},{title:"\u64CD\u4F5C",dataIndex:"option",valueType:"option",render:function(p,h){var b=[(0,t.jsx)("a",{onClick:function(){C(!0),v(h)},children:"\u7F16\u8F91"},"editor"),d("\u5220\u9664",h,me),d("\u53D1\u5E03",{id:h.id,state:"1"},ve)],$=[(0,t.jsx)("a",{onClick:function(){C(!0),v(h),e(!1)},children:"\u67E5\u770B"},"view")],f=(0,t.jsx)("a",{onClick:function(){i(!0),v(h),e(!0)},children:"\u5BA1\u6279"},"viewApproval");return w!="0"?[].concat($,[f]):[].concat(b,[f])}}];return(0,t.jsxs)(le.ZP,{children:[(0,t.jsx)(se.ZP,{actionRef:k,columns:P,rowKey:"id",request:ce,params:{state:w},search:!1,toolBarRender:function(){return[(0,t.jsxs)(G.Z,{type:"primary",onClick:function(){C(!0),v(null),e(!0)},children:[(0,t.jsx)(he.Z,{})," \u65B0\u5EFA"]},"primary"),(0,t.jsxs)(K.Z,{placeholder:"\u5F85\u53D1\u5E03",onChange:function(h,b){R(h)},children:[(0,t.jsx)(K.Z.Option,{value:"0",children:"\u5F85\u53D1\u5E03"}),(0,t.jsx)(K.Z.Option,{value:"1,2,3,4,5",children:"\u5DF2\u53D1\u5E03"})]})]}}),(0,t.jsx)(Ze,{modalVisible:M,onVisibleChange:C,currentRecord:I,updateDefinitionTable:function(){var p;return(p=k.current)===null||p===void 0?void 0:p.reload()},isEditor:c}),(0,t.jsx)(Ee.Z,{definitionId:(I==null?void 0:I.id)+"",visible:m,onVisibleChange:i})]})}},75640:function(oe,L,n){"use strict";var ie=n(3182),K=n(94043),Y=n.n(K),G=n(37476),H=n(19595),ue=n(67294),N=n(48971),F=n(85893);L.Z=function(z){var Z=(0,ue.useRef)(),g=[{dataIndex:"index",valueType:"indexBorder",width:48},{title:"\u5F53\u524D\u8282\u70B9",dataIndex:"kindName"},{title:"\u5BA1\u6279\u4EBA",dataIndex:"creatorName"},{title:"\u5B8C\u6210\u65F6\u95F4",sorter:!0,dataIndex:"createDate",valueType:"dateTime"},{title:"\u5BA1\u6279\u7C7B\u578B",dataIndex:"approvalResult",hideInForm:!0,valueEnum:{0:{text:"\u4E0D\u901A\u8FC7",status:"Error"},1:{text:"\u901A\u8FC7",status:"Success"}}},{title:"\u5BA1\u6279\u610F\u89C1",dataIndex:"approvalComment",valueType:"textarea"}];return(0,F.jsx)(G.Z,{title:"\u5BA1\u6279\u8BE6\u7EC6",width:"800px",layout:"horizontal",visible:z.visible,onVisibleChange:z.onVisibleChange,submitter:{searchConfig:{resetText:"\u5173\u95ED"},render:function(W,u){return[u[0]]}},children:(0,F.jsx)(H.ZP,{actionRef:Z,columns:g,rowKey:"id",search:!1,toolBarRender:!1,params:{definitionId:z.definitionId},request:function(){var y=(0,ie.Z)(Y().mark(function W(u){return Y().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",(0,N.WY)("/algz/approvalcommentmanger/approvalcomments",{params:u}));case 1:case"end":return s.stop()}},W)}));return function(W){return y.apply(this,arguments)}}()})})}}}]);
